# Plotting Expression Data 

## Plotting Raw Counts

Let's say we want to compare basal and LP samples. We will first look at the metadata.

```{r}
# View metadata
dge$samples
```

We will manually take the mean across basal samples and LP samples.

```{r}
# Collect the counts
raw_counts <- dge$counts
# Basal samples are columns 3, 4, and 7
basal_sample_means <- rowMeans2(raw_counts[, c(3, 4, 7)])
# LP samples are columns 1, 6, and 9
LP_sample_means <- rowMeans2(raw_counts[, c(1, 6, 9)])
```

Then we will plot the two groups.

```{r}
plot(basal_sample_means, LP_sample_means)
```

This is hard to interpret. Most of the genes are clustered in the bottom left corner.

## Transforming ($\log_{2}$)

Using a $\log_{2}$ transformation makes it easier to examine all the genes together.

```{r}
# Plot with log2 transformation
plot(log2(basal_sample_means), log2(LP_sample_means))
```

## Using Fold-Change

As stated at the very start of this chapter, plotting differences versus means can be very helpful when many genes are correlated. It also makes interpretation easier when combined with a $\log_{2}$ transformation.

When basal and LP expression are equal, fold-change is equal to zero.

```{r}
log2(10) - log2(10)
```

When basal expression is greater, fold-change is positive.

```{r}
log2(20) - log2(10)
log2(100) - log2(1)
```

However when LP expression is greater, fold-change is negative.

```{r}
log2(10) - log2(20)
log2(1) - log2(100)
```

Calculate fold-change for the data.

```{r}
log2_fold_change <- log2(basal_sample_means) - log2(LP_sample_means)
mean_expression <- (log2(basal_sample_means) + log2(LP_sample_means)) / 2
```

Plot the values above, with mean expression on the x-axis and fold-change on the y-axis.

```{r}
plot(mean_expression, log2_fold_change)
```

This gives us a very rough idea of how transformation and using fold-change can aid in interpretation of the data. In reality, we need to cover a few more steps before creating this kind of plot.
