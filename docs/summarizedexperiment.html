<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 The SummarizedExperiment class | Statistics for Genomics: Differential Expression</title>
  <meta name="description" content="Description about Course/Book." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 The SummarizedExperiment class | Statistics for Genomics: Differential Expression" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Description about Course/Book." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 The SummarizedExperiment class | Statistics for Genomics: Differential Expression" />
  
  <meta name="twitter:description" content="Description about Course/Book." />
  



<meta name="date" content="2022-08-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/anvil_favicon.ico" type="image/x-icon" />
<link rel="prev" href="rstudio.html"/>
<link rel="next" href="transformation-fold-change-ma-plots.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style_anvil.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://anvilproject.org/" target="_blank"><img src="assets/logo-anvil.png" style="width: 80%; padding-left: 15px; padding-top: 8px;"</a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Book</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#anvil-collection"><i class="fa fa-check"></i>AnVIL Collection</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="overview-and-learning-objectives.html"><a href="overview-and-learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Overview and Learning Objectives</a>
<ul>
<li class="chapter" data-level="1.1" data-path="overview-and-learning-objectives.html"><a href="overview-and-learning-objectives.html#activity-context"><i class="fa fa-check"></i><b>1.1</b> Activity Context</a></li>
<li class="chapter" data-level="1.2" data-path="overview-and-learning-objectives.html"><a href="overview-and-learning-objectives.html#learning-objectives"><i class="fa fa-check"></i><b>1.2</b> Learning Objectives</a></li>
</ul></li>
<li class="part"><span><b>RStudio on AnVIL</b></span></li>
<li class="chapter" data-level="2" data-path="getting-set-up.html"><a href="getting-set-up.html"><i class="fa fa-check"></i><b>2</b> Getting Set Up</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-set-up.html"><a href="getting-set-up.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="getting-set-up.html"><a href="getting-set-up.html#create-a-google-account"><i class="fa fa-check"></i><b>2.2</b> Create a Google Account</a></li>
<li class="chapter" data-level="2.3" data-path="getting-set-up.html"><a href="getting-set-up.html#sign-in-to-terra"><i class="fa fa-check"></i><b>2.3</b> Sign in to Terra</a></li>
<li class="chapter" data-level="2.4" data-path="getting-set-up.html"><a href="getting-set-up.html#share-your-id"><i class="fa fa-check"></i><b>2.4</b> Share your ID</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workspace.html"><a href="workspace.html"><i class="fa fa-check"></i><b>3</b> Creating a Workspace</a></li>
<li class="chapter" data-level="4" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i><b>4</b> Working in RStudio</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rstudio.html"><a href="rstudio.html#launch-rstudio-cloud-environment"><i class="fa fa-check"></i><b>4.1</b> Launch RStudio Cloud Environment</a></li>
<li class="chapter" data-level="4.2" data-path="rstudio.html"><a href="rstudio.html#tour-rstudio"><i class="fa fa-check"></i><b>4.2</b> Tour RStudio</a></li>
<li class="chapter" data-level="4.3" data-path="rstudio.html"><a href="rstudio.html#more-practice-with-isee"><i class="fa fa-check"></i><b>4.3</b> More Practice with <code>iSEE</code></a></li>
<li class="chapter" data-level="4.4" data-path="rstudio.html"><a href="rstudio.html#stopping"><i class="fa fa-check"></i><b>4.4</b> Pause RStudio</a></li>
<li class="chapter" data-level="4.5" data-path="rstudio.html"><a href="rstudio.html#delete-rstudio-cloud-environment"><i class="fa fa-check"></i><b>4.5</b> Delete RStudio Cloud Environment</a></li>
<li class="chapter" data-level="4.6" data-path="rstudio.html"><a href="rstudio.html#video-guide"><i class="fa fa-check"></i><b>4.6</b> Video Guide</a></li>
</ul></li>
<li class="part"><span><b>EXPRESSION DATA</b></span></li>
<li class="chapter" data-level="5" data-path="summarizedexperiment.html"><a href="summarizedexperiment.html"><i class="fa fa-check"></i><b>5</b> The <code>SummarizedExperiment</code> class</a>
<ul>
<li class="chapter" data-level="5.1" data-path="summarizedexperiment.html"><a href="summarizedexperiment.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="summarizedexperiment.html"><a href="summarizedexperiment.html#exploring-summarizedexperiment"><i class="fa fa-check"></i><b>5.2</b> Exploring <code>SummarizedExperiment</code></a></li>
<li class="chapter" data-level="5.3" data-path="summarizedexperiment.html"><a href="summarizedexperiment.html#subsetting-summarizedexperiment"><i class="fa fa-check"></i><b>5.3</b> Subsetting <code>SummarizedExperiment</code></a></li>
<li class="chapter" data-level="5.4" data-path="summarizedexperiment.html"><a href="summarizedexperiment.html#recap"><i class="fa fa-check"></i><b>5.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="transformation-fold-change-ma-plots.html"><a href="transformation-fold-change-ma-plots.html"><i class="fa fa-check"></i><b>6</b> Transformation, Fold-change, &amp; MA Plots</a>
<ul>
<li class="chapter" data-level="6.1" data-path="transformation-fold-change-ma-plots.html"><a href="transformation-fold-change-ma-plots.html#gene-expression-data"><i class="fa fa-check"></i><b>6.1</b> Gene Expression Data</a></li>
<li class="chapter" data-level="6.2" data-path="transformation-fold-change-ma-plots.html"><a href="transformation-fold-change-ma-plots.html#plotting-raw-counts"><i class="fa fa-check"></i><b>6.2</b> Plotting Raw Counts</a></li>
<li class="chapter" data-level="6.3" data-path="transformation-fold-change-ma-plots.html"><a href="transformation-fold-change-ma-plots.html#transforming-log_2"><i class="fa fa-check"></i><b>6.3</b> Transforming (<span class="math inline">\(\log_{2}\)</span>)</a></li>
<li class="chapter" data-level="6.4" data-path="transformation-fold-change-ma-plots.html"><a href="transformation-fold-change-ma-plots.html#using-fold-change-to-create-an-ma-plot"><i class="fa fa-check"></i><b>6.4</b> Using Fold-Change to Create an MA Plot</a></li>
<li class="chapter" data-level="6.5" data-path="transformation-fold-change-ma-plots.html"><a href="transformation-fold-change-ma-plots.html#future-directions"><i class="fa fa-check"></i><b>6.5</b> Future Directions</a></li>
<li class="chapter" data-level="6.6" data-path="transformation-fold-change-ma-plots.html"><a href="transformation-fold-change-ma-plots.html#recap-1"><i class="fa fa-check"></i><b>6.6</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="design-matrices.html"><a href="design-matrices.html"><i class="fa fa-check"></i><b>7</b> Design Matrices</a>
<ul>
<li class="chapter" data-level="7.1" data-path="design-matrices.html"><a href="design-matrices.html#overview-1"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="design-matrices.html"><a href="design-matrices.html#types-of-models"><i class="fa fa-check"></i><b>7.2</b> Types of Models</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="design-matrices.html"><a href="design-matrices.html#regression-continuous-variables"><i class="fa fa-check"></i><b>7.2.1</b> Regression: Continuous Variables</a></li>
<li class="chapter" data-level="7.2.2" data-path="design-matrices.html"><a href="design-matrices.html#means-categorical-variables"><i class="fa fa-check"></i><b>7.2.2</b> Means: Categorical Variables</a></li>
<li class="chapter" data-level="7.2.3" data-path="design-matrices.html"><a href="design-matrices.html#mean-reference-categorical-variables"><i class="fa fa-check"></i><b>7.2.3</b> Mean-Reference: Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="design-matrices.html"><a href="design-matrices.html#making-a-design-matrix"><i class="fa fa-check"></i><b>7.3</b> Making a Design Matrix</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="design-matrices.html"><a href="design-matrices.html#regression-continuous-variables-1"><i class="fa fa-check"></i><b>7.3.1</b> Regression: Continuous Variables</a></li>
<li class="chapter" data-level="7.3.2" data-path="design-matrices.html"><a href="design-matrices.html#means"><i class="fa fa-check"></i><b>7.3.2</b> Means: Categorical Variables</a></li>
<li class="chapter" data-level="7.3.3" data-path="design-matrices.html"><a href="design-matrices.html#meanref"><i class="fa fa-check"></i><b>7.3.3</b> Mean-Reference: Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="design-matrices.html"><a href="design-matrices.html#more-complex-designs"><i class="fa fa-check"></i><b>7.4</b> More Complex Designs</a></li>
<li class="chapter" data-level="7.5" data-path="design-matrices.html"><a href="design-matrices.html#inpractice"><i class="fa fa-check"></i><b>7.5</b> Design Matrix in Practice</a></li>
<li class="chapter" data-level="7.6" data-path="design-matrices.html"><a href="design-matrices.html#recap-2"><i class="fa fa-check"></i><b>7.6</b> Recap</a></li>
</ul></li>
<li class="part"><span><b>PUTTING IT TOGETHER</b></span></li>
<li class="chapter" data-level="8" data-path="simple-model-fitting.html"><a href="simple-model-fitting.html"><i class="fa fa-check"></i><b>8</b> Simple Model Fitting</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simple-model-fitting.html"><a href="simple-model-fitting.html#overview-2"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="simple-model-fitting.html"><a href="simple-model-fitting.html#load-prepare-data"><i class="fa fa-check"></i><b>8.2</b> Load &amp; Prepare Data</a></li>
<li class="chapter" data-level="8.3" data-path="simple-model-fitting.html"><a href="simple-model-fitting.html#creating-the-design-matrix"><i class="fa fa-check"></i><b>8.3</b> Creating the Design Matrix</a></li>
<li class="chapter" data-level="8.4" data-path="simple-model-fitting.html"><a href="simple-model-fitting.html#testing-with-lmfit-and-ebayes"><i class="fa fa-check"></i><b>8.4</b> Testing with <code>lmFit</code> and <code>eBayes</code></a></li>
<li class="chapter" data-level="8.5" data-path="simple-model-fitting.html"><a href="simple-model-fitting.html#interpreting-toptable-output"><i class="fa fa-check"></i><b>8.5</b> Interpreting <code>topTable()</code> Output</a></li>
<li class="chapter" data-level="8.6" data-path="simple-model-fitting.html"><a href="simple-model-fitting.html#recap-3"><i class="fa fa-check"></i><b>8.6</b> Recap</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>A</b> Help</a></li>
<li class="chapter" data-level="B" data-path="give-us-feedback.html"><a href="give-us-feedback.html"><i class="fa fa-check"></i><b>B</b> Give Us Feedback</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="divider"></li>
<p style="text-align:center;"> <a href="https://github.com/jhudsl/DaSL_Course_Template_Bookdown" target="blank" > This content was published with</a> <a href="https://bookdown.org/" target="blank"> bookdown by: </a> </p>
<p style="text-align:center;"> <a href="http://jhudatascience.org/"> The Johns Hopkins Data Science Lab </a></p>
<a href="http://jhudatascience.org/"><img src="https://jhudatascience.org/images/dasl.png" style=" width: 80%; padding-left: 40px; padding-top: 8px; vertical-align: top "</a>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Genomics: Differential Expression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <!--<script src="assets/hideOutput.js"></script>-->
  <link href="assets/style_anvil.css" rel="stylesheet">
</head>
        


<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/dasl_thin_main_image.png">
</div>
<div id="summarizedexperiment" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> The <code>SummarizedExperiment</code> class</h1>
<div id="overview" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Overview</h2>
<p>One of the main strengths of using Bioconductor for bioinformatics is their data infrastructure. These data classes are built with genomics data in mind. This makes data compatible with different packages and/or methods. It also makes data easier to manipulate.</p>
<p>The <code>SummarizedExperiment</code> class is used to store rectangular matrices of experimental results, which are commonly produced by sequencing and microarray experiments. Each <code>SummarizedExperiment</code> stores observations of one or more samples, along with additional meta-data describing both the observations (features) and samples (phenotypes).</p>
<p>A key aspect of the <code>SummarizedExperiment</code> class is the coordination of the meta-data and assays when subsetting. For example, if you want to exclude a given sample you can do for both the meta-data and assay in one operation, which ensures the meta-data and observed data will remain in sync. Improperly accounting for meta and observational data has resulted in a number of incorrect results and retractions so this is a very desirable property.</p>
<p><code>SummarizedExperiment</code> is a matrix-like container where rows represent features of interest (e.g. genes, transcripts, exons, etc.) and columns represent samples. The objects contain one or more assays, each represented by a matrix-like object of numeric or other mode. The rows of a <code>SummarizedExperiment</code> object represent features of interest. Information about these features is stored in a DataFrame object, accessible using the function rowData(). Each row of the DataFrame provides information on the feature in the corresponding row of the <code>SummarizedExperiment</code> object. Columns of the DataFrame represent different attributes of the features of interest, e.g., gene or transcript IDs, etc.</p>
<p><img src="05-SummarizedExperiment_files/figure-html/1BLTCaogA04bbeSD1tR1Wt-mVceQA6FHXa8FmFzIARrg_g1206a30969e_0_0.png" title="Schematic for the SummarizedExperiment class geometry highlighting the vertical (column) and horizontal (row) relationships. A specific sample in yellow and a specific feature or gene in purple." alt="Schematic for the SummarizedExperiment class geometry highlighting the vertical (column) and horizontal (row) relationships. A specific sample in yellow and a specific feature or gene in purple." width="480" /></p>
<p>The above information comes directly from the <a href="https://bioconductor.org/packages/release/bioc/vignettes/SummarizedExperiment/inst/doc/SummarizedExperiment.html">vignette</a> for <code>SummarizedExperiment</code>. Please check out their page for more information.</p>
</div>
<div id="exploring-summarizedexperiment" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Exploring <code>SummarizedExperiment</code></h2>
<p>First, we will load the necessary packages.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="summarizedexperiment.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load airway</span></span>
<span id="cb9-2"><a href="summarizedexperiment.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># AnVIL::install(c(&quot;airway&quot;))</span></span>
<span id="cb9-3"><a href="summarizedexperiment.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(airway)</span></code></pre></div>
<p>Load the gene expression data. The “airway” data is from an RNA-Seq experiment on four human airway smooth muscle cell lines treated with dexamethasone. You can learn more about the experiment in <span class="citation">Himes (<a href="#ref-Himes2014" role="doc-biblioref">2014</a>)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="summarizedexperiment.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the gene expression data</span></span>
<span id="cb10-2"><a href="summarizedexperiment.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(airway)</span></code></pre></div>
<p><code>assay()</code> provides a matrix-like or list of matrix-like objects of identical dimension.</p>
<ul>
<li>rows: genes, genomic coordinates, etc.</li>
<li>columns: samples, cells, etc.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="summarizedexperiment.html#cb11-1" aria-hidden="true" tabindex="-1"></a>assay_data <span class="ot">&lt;-</span> <span class="fu">assay</span>(airway)</span>
<span id="cb11-2"><a href="summarizedexperiment.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(assay_data)</span></code></pre></div>
<pre><code>##                 SRR1039508 SRR1039509 SRR1039512 SRR1039513 SRR1039516
## ENSG00000000003        679        448        873        408       1138
## ENSG00000000005          0          0          0          0          0
## ENSG00000000419        467        515        621        365        587
## ENSG00000000457        260        211        263        164        245
## ENSG00000000460         60         55         40         35         78
## ENSG00000000938          0          0          2          0          1
##                 SRR1039517 SRR1039520 SRR1039521
## ENSG00000000003       1047        770        572
## ENSG00000000005          0          0          0
## ENSG00000000419        799        417        508
## ENSG00000000457        331        233        229
## ENSG00000000460         63         76         60
## ENSG00000000938          0          0          0</code></pre>
<p><code>colData()</code> provides annotations on each column, as a DataFrame. In other words, it provides descriptions of each sample.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="summarizedexperiment.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colData</span>(airway)</span></code></pre></div>
<pre><code>## DataFrame with 8 rows and 9 columns
##            SampleName     cell      dex    albut        Run avgLength
##              &lt;factor&gt; &lt;factor&gt; &lt;factor&gt; &lt;factor&gt;   &lt;factor&gt; &lt;integer&gt;
## SRR1039508 GSM1275862  N61311     untrt    untrt SRR1039508       126
## SRR1039509 GSM1275863  N61311     trt      untrt SRR1039509       126
## SRR1039512 GSM1275866  N052611    untrt    untrt SRR1039512       126
## SRR1039513 GSM1275867  N052611    trt      untrt SRR1039513        87
## SRR1039516 GSM1275870  N080611    untrt    untrt SRR1039516       120
## SRR1039517 GSM1275871  N080611    trt      untrt SRR1039517       126
## SRR1039520 GSM1275874  N061011    untrt    untrt SRR1039520       101
## SRR1039521 GSM1275875  N061011    trt      untrt SRR1039521        98
##            Experiment    Sample    BioSample
##              &lt;factor&gt;  &lt;factor&gt;     &lt;factor&gt;
## SRR1039508  SRX384345 SRS508568 SAMN02422669
## SRR1039509  SRX384346 SRS508567 SAMN02422675
## SRR1039512  SRX384349 SRS508571 SAMN02422678
## SRR1039513  SRX384350 SRS508572 SAMN02422670
## SRR1039516  SRX384353 SRS508575 SAMN02422682
## SRR1039517  SRX384354 SRS508576 SAMN02422673
## SRR1039520  SRX384357 SRS508579 SAMN02422683
## SRR1039521  SRX384358 SRS508580 SAMN02422677</code></pre>
<p><code>rowData()</code> and / or <code>rowRanges()</code> provide annotations on each row.</p>
<ul>
<li><code>rowRanges()</code>: coordinates of gene / exons in transcripts / etc.</li>
<li><code>rowData()</code>: P-values and log-fold change of each gene after differential expression analysis.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="summarizedexperiment.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowRanges</span>(airway)</span></code></pre></div>
<pre><code>## GRangesList object of length 64102:
## $ENSG00000000003
## GRanges object with 17 ranges and 2 metadata columns:
##        seqnames            ranges strand |   exon_id       exon_name
##           &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt;     &lt;character&gt;
##    [1]        X 99883667-99884983      - |    667145 ENSE00001459322
##    [2]        X 99885756-99885863      - |    667146 ENSE00000868868
##    [3]        X 99887482-99887565      - |    667147 ENSE00000401072
##    [4]        X 99887538-99887565      - |    667148 ENSE00001849132
##    [5]        X 99888402-99888536      - |    667149 ENSE00003554016
##    ...      ...               ...    ... .       ...             ...
##   [13]        X 99890555-99890743      - |    667156 ENSE00003512331
##   [14]        X 99891188-99891686      - |    667158 ENSE00001886883
##   [15]        X 99891605-99891803      - |    667159 ENSE00001855382
##   [16]        X 99891790-99892101      - |    667160 ENSE00001863395
##   [17]        X 99894942-99894988      - |    667161 ENSE00001828996
##   -------
##   seqinfo: 722 sequences (1 circular) from an unspecified genome
## 
## ...
## &lt;64101 more elements&gt;</code></pre>
<p>metadata(): List of unstructured metadata describing the overall content of the object.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="summarizedexperiment.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span>(airway)</span></code></pre></div>
<pre><code>## [[1]]
## Experiment data
##   Experimenter name: Himes BE 
##   Laboratory: NA 
##   Contact information:  
##   Title: RNA-Seq transcriptome profiling identifies CRISPLD2 as a glucocorticoid responsive gene that modulates cytokine function in airway smooth muscle cells. 
##   URL: http://www.ncbi.nlm.nih.gov/pubmed/24926665 
##   PMIDs: 24926665 
## 
##   Abstract: A 226 word abstract is available. Use &#39;abstract&#39; method.</code></pre>
<p>Please see <a href="https://bioconductor.org/help/course-materials/2019/BSS2019/04_Practical_CoreApproachesInBioconductor.html">this vignette</a> for more information.</p>
</div>
<div id="subsetting-summarizedexperiment" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Subsetting <code>SummarizedExperiment</code></h2>
<p>Often, you’ll find you want to subset your expression/count data. You can do this by selecting the samples (columns) or features/genes (rows) you want to keep.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="summarizedexperiment.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect the counts and sample data</span></span>
<span id="cb19-2"><a href="summarizedexperiment.html#cb19-2" aria-hidden="true" tabindex="-1"></a>raw_counts <span class="ot">&lt;-</span> <span class="fu">assay</span>(airway)</span>
<span id="cb19-3"><a href="summarizedexperiment.html#cb19-3" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">colData</span>(airway)</span>
<span id="cb19-4"><a href="summarizedexperiment.html#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="summarizedexperiment.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Select samples 1 and 2</span></span>
<span id="cb19-6"><a href="summarizedexperiment.html#cb19-6" aria-hidden="true" tabindex="-1"></a>samples_1_2 <span class="ot">&lt;-</span> raw_counts[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb19-7"><a href="summarizedexperiment.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(samples_1_2)</span></code></pre></div>
<pre><code>##                 SRR1039508 SRR1039509
## ENSG00000000003        679        448
## ENSG00000000005          0          0
## ENSG00000000419        467        515
## ENSG00000000457        260        211
## ENSG00000000460         60         55
## ENSG00000000938          0          0</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="summarizedexperiment.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select untreated samples</span></span>
<span id="cb21-2"><a href="summarizedexperiment.html#cb21-2" aria-hidden="true" tabindex="-1"></a>untrt_samples <span class="ot">&lt;-</span> raw_counts[, sample_data<span class="sc">$</span>dex <span class="sc">==</span> <span class="st">&quot;untrt&quot;</span>]</span>
<span id="cb21-3"><a href="summarizedexperiment.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(untrt_samples)</span></code></pre></div>
<pre><code>##                 SRR1039508 SRR1039512 SRR1039516 SRR1039520
## ENSG00000000003        679        873       1138        770
## ENSG00000000005          0          0          0          0
## ENSG00000000419        467        621        587        417
## ENSG00000000457        260        263        245        233
## ENSG00000000460         60         40         78         76
## ENSG00000000938          0          2          1          0</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="summarizedexperiment.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select features where mean expression &gt; 0 across samples</span></span>
<span id="cb23-2"><a href="summarizedexperiment.html#cb23-2" aria-hidden="true" tabindex="-1"></a>nonzero_features <span class="ot">&lt;-</span> raw_counts[<span class="fu">rowMeans</span>(raw_counts) <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb23-3"><a href="summarizedexperiment.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nonzero_features)</span></code></pre></div>
<pre><code>##                 SRR1039508 SRR1039509 SRR1039512 SRR1039513 SRR1039516
## ENSG00000000003        679        448        873        408       1138
## ENSG00000000419        467        515        621        365        587
## ENSG00000000457        260        211        263        164        245
## ENSG00000000460         60         55         40         35         78
## ENSG00000000938          0          0          2          0          1
## ENSG00000000971       3251       3679       6177       4252       6721
##                 SRR1039517 SRR1039520 SRR1039521
## ENSG00000000003       1047        770        572
## ENSG00000000419        799        417        508
## ENSG00000000457        331        233        229
## ENSG00000000460         63         76         60
## ENSG00000000938          0          0          0
## ENSG00000000971      11027       5176       7995</code></pre>
</div>
<div id="recap" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Recap</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="summarizedexperiment.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Learn more about the class</span></span>
<span id="cb25-2"><a href="summarizedexperiment.html#cb25-2" aria-hidden="true" tabindex="-1"></a>?SummarizedExperiment<span class="sc">::</span><span class="st">`</span><span class="at">SummarizedExperiment-class</span><span class="st">`</span></span>
<span id="cb25-3"><a href="summarizedexperiment.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Browse vignettes and more</span></span>
<span id="cb25-4"><a href="summarizedexperiment.html#cb25-4" aria-hidden="true" tabindex="-1"></a>??SummarizedExperiment</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="summarizedexperiment.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.1.3 (2022-03-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.4 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats4    stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] airway_1.14.0               SummarizedExperiment_1.24.0
##  [3] Biobase_2.54.0              GenomicRanges_1.46.1       
##  [5] GenomeInfoDb_1.30.1         IRanges_2.28.0             
##  [7] S4Vectors_0.32.4            BiocGenerics_0.40.0        
##  [9] MatrixGenerics_1.6.0        matrixStats_0.61.0         
## 
## loaded via a namespace (and not attached):
##  [1] XVector_0.34.0         bslib_0.3.1            compiler_4.1.3        
##  [4] pillar_1.7.0           jquerylib_0.1.4        highr_0.9             
##  [7] zlibbioc_1.40.0        bitops_1.0-7           tools_4.1.3           
## [10] digest_0.6.29          lattice_0.20-45        jsonlite_1.8.0        
## [13] evaluate_0.15          lifecycle_1.0.1        tibble_3.1.6          
## [16] pkgconfig_2.0.3        png_0.1-7              rlang_1.0.2           
## [19] Matrix_1.4-0           DelayedArray_0.20.0    cli_3.2.0             
## [22] curl_4.3.2             yaml_2.3.5             xfun_0.26             
## [25] fastmap_1.1.0          GenomeInfoDbData_1.2.7 stringr_1.4.0         
## [28] httr_1.4.2             knitr_1.33             fs_1.5.2              
## [31] vctrs_0.4.1            sass_0.4.1             hms_1.1.1             
## [34] grid_4.1.3             glue_1.6.2             R6_2.5.1              
## [37] fansi_1.0.3            ottrpal_1.0.1          rmarkdown_2.10        
## [40] bookdown_0.24          readr_2.1.2            tzdb_0.3.0            
## [43] magrittr_2.0.3         ellipsis_0.3.2         htmltools_0.5.2       
## [46] utf8_1.2.2             stringi_1.7.6          RCurl_1.98-1.6        
## [49] crayon_1.5.1</code></pre>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Himes2014" class="csl-entry">
Himes, Xiaofeng AND Wagner, Blanca E. AND Jiang. 2014. <span>“RNA-Seq Transcriptome Profiling Identifies Crispld2 as a Glucocorticoid Responsive Gene That Modulates Cytokine Function in Airway Smooth Muscle Cells.”</span> <em>PLOS ONE</em> 9 (6): 1–13. <a href="https://doi.org/10.1371/journal.pone.0099625">https://doi.org/10.1371/journal.pone.0099625</a>.
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="rstudio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="transformation-fold-change-ma-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jhudsl/GDSCN_Book_Statistics_for_Genomics_Differential_Expression/edit/main/05-SummarizedExperiment.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
